import { OperationCanceledError } from "./cancellation";
/**
 * Wrapper for setTimeout as cancellable async function
 *
 * Example:
 * ```ts
 * console.log("then");
 * await sleep(1000);
 * console.log("now");
 * ```
 */
export function sleep(millis, cancellationToken) {
    let timeoutId;
    return new Promise((resolve, reject) => {
        timeoutId = setTimeout(() => {
            resolve();
            timeoutId = (void 0);
        }, millis);
        if (cancellationToken) {
            cancellationToken.register(() => {
                clearTimeout(timeoutId);
                timeoutId = (void 0);
                reject(new OperationCanceledError(cancellationToken));
            });
        }
    });
}
//# sourceMappingURL=sleep.js.map